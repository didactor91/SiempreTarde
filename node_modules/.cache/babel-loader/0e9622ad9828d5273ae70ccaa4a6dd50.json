{"ast":null,"code":"var _jsxFileName = \"/Users/didactor/Documents/skylab/bootcamp/collab/skylab-bootcamp-201904/staff/groups/aldi/siempre-tarde/src/componets/App.js\";\nimport React, { Component } from 'react';\nimport i18n from '../common/i18n';\nimport LanguageSelector from './LanguageSelector';\nimport Landing from './Landing';\nimport Register from './Register';\nimport Login from './Login';\nimport logic from '../logic';\nimport Home from './Home';\nimport StopCode from './StopCode';\nimport StopLine from './StopLine';\nimport Results from './Results';\nimport { Route, withRouter, Redirect, Switch } from 'react-router-dom';\nimport Favorites from './Favorites';\nimport CodeSearch from './CodeSearch';\nimport LineSearch from './LineSearch';\nimport ResultsFav from './ResultsFav';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      lang: i18n.language,\n      visible: null,\n      error: null,\n      line: null,\n      stop: null,\n      lines: [],\n      favs: []\n    };\n\n    this.handleLanguageChange = lang => this.setState({\n      lang: i18n.language = lang\n    });\n\n    this.handleRegisterNavigation = () => this.props.history.push('/register');\n\n    this.handleLoginNavigation = () => this.props.history.push('/login');\n\n    this.handleLogin = (username, password) => {\n      try {\n        logic.loginUser(username, password).then(() => logic.retrieveUser()).then(({\n          name\n        }) => {\n          this.setState({\n            name,\n            error: null\n          }, () => this.props.history.push('/home'));\n        }).catch(error => this.setState({\n          error: error.message\n        }));\n      } catch (_ref) {\n        let message = _ref.message;\n        this.setState({\n          error: message\n        });\n      }\n    };\n\n    this.handleRegister = (name, surname, username, password, password2) => {\n      try {\n        logic.registerUser(name, surname, username, password, password2).then(() => {\n          this.setState({\n            error: null\n          }, () => this.props.history.push('/login'));\n        }).catch(error => {\n          this.setState({\n            error: error.message\n          });\n        });\n      } catch (_ref2) {\n        let message = _ref2.message;\n        this.setState({\n          error: message\n        });\n      }\n    };\n\n    this.handleStopCode = () => {\n      this.setState(() => this.props.history.push('/byidstop'));\n    };\n\n    this.handleLineCode = () => {\n      logic.retrieveBusLines(undefined).then(resp => {\n        this.setState({\n          error: null,\n          lines: resp\n        }, () => this.props.history.push('/byidline'));\n      });\n    };\n\n    this.handleFavorites = () => {\n      logic.retrieveFavStops().then(favs => this.setState({\n        favs\n      }, () => this.props.history.push('/favoritestops')));\n    };\n\n    this.handleFavOut = stop_id => {\n      logic.toggleFavStop(stop_id).then(() => logic.retrieveFavStops()).then(favs => this.setState({\n        favs\n      }, () => this.props.history.push('/favoritestops')));\n    };\n\n    this.handleLogout = () => {\n      logic.logoutUser();\n      this.props.history.push('/');\n    };\n\n    this.handleFav = id => logic.toggleFavStop(id).then(() => logic.retrieveFavStops()).then(favs => this.setState({\n      favs\n    }));\n\n    this.handleSee = stop_id => logic.upcomingBusesByStop(stop_id).then(lines => {\n      logic.retrieveFavStops().then(favs => this.setState({\n        error: null,\n        line: null,\n        favs,\n        lines,\n        stop: stop_id\n      }, () => this.props.history.push('/favoritestops/results')));\n    }).catch(error => this.setState({\n      error: error.message\n    }));\n  }\n\n  componentDidMount() {\n    logic.isUserLoggedIn && logic.retrieveUser().then(user => this.setState({\n      name: user.name\n    })).catch(error => this.setState({\n      error: error.message\n    }));\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.location !== prevProps.location) this.setState({\n      visible: null\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          lang = _this$state.lang,\n          error = _this$state.error,\n          lines = _this$state.lines,\n          line = _this$state.line,\n          favs = _this$state.favs,\n          stop = _this$state.stop,\n          handleLanguageChange = this.handleLanguageChange,\n          handleRegisterNavigation = this.handleRegisterNavigation,\n          handleLoginNavigation = this.handleLoginNavigation,\n          handleLogin = this.handleLogin,\n          handleRegister = this.handleRegister,\n          handleLogout = this.handleLogout,\n          handleStopCode = this.handleStopCode,\n          handleLineCode = this.handleLineCode,\n          handleFavorites = this.handleFavorites,\n          handleFavOut = this.handleFavOut,\n          handleFav = this.handleFav,\n          handleSee = this.handleSee;\n    return React.createElement(\"div\", {\n      className: \"main-app\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(LanguageSelector, {\n      lang: lang,\n      onLanguageChange: handleLanguageChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }), React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }) : React.createElement(Landing, {\n        lang: lang,\n        onRegister: handleRegisterNavigation,\n        onLogin: handleLoginNavigation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/register\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }) : React.createElement(Register, {\n        lang: lang,\n        onRegister: handleRegister,\n        error: error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/login\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }) : React.createElement(Login, {\n        lang: lang,\n        onLogin: handleLogin,\n        error: error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/home\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Home, {\n        lang: lang,\n        onStopCode: handleStopCode,\n        onLineCode: handleLineCode,\n        onFavorites: handleFavorites,\n        onLogout: handleLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/byidstop\",\n      render: () => logic.isUserLoggedIn ? React.createElement(CodeSearch, {\n        lang: lang,\n        items: lines,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/byidline\",\n      render: () => logic.isUserLoggedIn ? React.createElement(LineSearch, {\n        lang: lang,\n        items: lines,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/favoritestops\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Favorites, {\n        lang: lang,\n        favs: favs,\n        onFavOut: handleFavOut,\n        onSee: handleSee,\n        onFavorites: handleFavorites,\n        stop: stop,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/favoritestops/results\",\n      render: () => logic.isUserLoggedIn ? React.createElement(ResultsFav, {\n        lang: lang,\n        items: lines,\n        onFav: handleFav,\n        stop: stop,\n        error: error,\n        favs: favs,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }), React.createElement(Redirect, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["/Users/didactor/Documents/skylab/bootcamp/collab/skylab-bootcamp-201904/staff/groups/aldi/siempre-tarde/src/componets/App.js"],"names":["React","Component","i18n","LanguageSelector","Landing","Register","Login","logic","Home","StopCode","StopLine","Results","Route","withRouter","Redirect","Switch","Favorites","CodeSearch","LineSearch","ResultsFav","App","state","lang","language","visible","error","line","stop","lines","favs","handleLanguageChange","setState","handleRegisterNavigation","props","history","push","handleLoginNavigation","handleLogin","username","password","loginUser","then","retrieveUser","name","catch","message","handleRegister","surname","password2","registerUser","handleStopCode","handleLineCode","retrieveBusLines","undefined","resp","handleFavorites","retrieveFavStops","handleFavOut","stop_id","toggleFavStop","handleLogout","logoutUser","handleFav","id","handleSee","upcomingBusesByStop","componentDidMount","isUserLoggedIn","user","componentDidUpdate","prevProps","location","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,IAAP,MAAiB,gBAAjB;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,KAAP,MAAkB,UAAlB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,SAASC,KAAT,EAAgBC,UAAhB,EAA4BC,QAA5B,EAAsCC,MAAtC,QAAoD,kBAApD;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,UAAP,MAAuB,cAAvB;;AAIA,MAAMC,GAAN,SAAkBnB,SAAlB,CAA4B;AAAA;AAAA;AAAA,SACxBoB,KADwB,GAChB;AAAEC,MAAAA,IAAI,EAAEpB,IAAI,CAACqB,QAAb;AAAuBC,MAAAA,OAAO,EAAE,IAAhC;AAAsCC,MAAAA,KAAK,EAAE,IAA7C;AAAmDC,MAAAA,IAAI,EAAE,IAAzD;AAA+DC,MAAAA,IAAI,EAAE,IAArE;AAA2EC,MAAAA,KAAK,EAAE,EAAlF;AAAsFC,MAAAA,IAAI,EAAE;AAA5F,KADgB;;AAAA,SAGxBC,oBAHwB,GAGDR,IAAI,IAAI,KAAKS,QAAL,CAAc;AAAET,MAAAA,IAAI,EAAEpB,IAAI,CAACqB,QAAL,GAAgBD;AAAxB,KAAd,CAHP;;AAAA,SAKxBU,wBALwB,GAKG,MAAM,KAAKC,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,WAAxB,CALT;;AAAA,SAOxBC,qBAPwB,GAOA,MAAM,KAAKH,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,QAAxB,CAPN;;AAAA,SASxBE,WATwB,GASV,CAACC,QAAD,EAAWC,QAAX,KAAwB;AAClC,UAAI;AACAhC,QAAAA,KAAK,CAACiC,SAAN,CAAgBF,QAAhB,EAA0BC,QAA1B,EACKE,IADL,CACU,MACFlC,KAAK,CAACmC,YAAN,EAFR,EAIKD,IAJL,CAIU,CAAC;AAAEE,UAAAA;AAAF,SAAD,KAAc;AAChB,eAAKZ,QAAL,CAAc;AAAEY,YAAAA,IAAF;AAAQlB,YAAAA,KAAK,EAAE;AAAf,WAAd,EAAqC,MAAM,KAAKQ,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,OAAxB,CAA3C;AACH,SANL,EAOKS,KAPL,CAOWnB,KAAK,IACR,KAAKM,QAAL,CAAc;AAAEN,UAAAA,KAAK,EAAEA,KAAK,CAACoB;AAAf,SAAd,CARR;AAUH,OAXD,CAWE,aAAoB;AAAA,YAAXA,OAAW,QAAXA,OAAW;AAClB,aAAKd,QAAL,CAAc;AAAEN,UAAAA,KAAK,EAAEoB;AAAT,SAAd;AACH;AACJ,KAxBuB;;AAAA,SAqCxBC,cArCwB,GAqCP,CAACH,IAAD,EAAOI,OAAP,EAAgBT,QAAhB,EAA0BC,QAA1B,EAAoCS,SAApC,KAAkD;AAC/D,UAAI;AAEAzC,QAAAA,KAAK,CAAC0C,YAAN,CAAmBN,IAAnB,EAAyBI,OAAzB,EAAkCT,QAAlC,EAA4CC,QAA5C,EAAsDS,SAAtD,EACKP,IADL,CACU,MAAM;AACR,eAAKV,QAAL,CAAc;AAAEN,YAAAA,KAAK,EAAE;AAAT,WAAd,EAA+B,MAAM,KAAKQ,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,QAAxB,CAArC;AACH,SAHL,EAIKS,KAJL,CAIWnB,KAAK,IAAI;AACZ,eAAKM,QAAL,CAAc;AAAEN,YAAAA,KAAK,EAAEA,KAAK,CAACoB;AAAf,WAAd;AACH,SANL;AAOH,OATD,CASE,cAAoB;AAAA,YAAXA,OAAW,SAAXA,OAAW;AAClB,aAAKd,QAAL,CAAc;AAAEN,UAAAA,KAAK,EAAEoB;AAAT,SAAd;AACH;AACJ,KAlDuB;;AAAA,SAmDxBK,cAnDwB,GAmDP,MAAM;AAEnB,WAAKnB,QAAL,CAAc,MAAM,KAAKE,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,WAAxB,CAApB;AACH,KAtDuB;;AAAA,SAuDxBgB,cAvDwB,GAuDP,MAAM;AACnB5C,MAAAA,KAAK,CAAC6C,gBAAN,CAAuBC,SAAvB,EAAkCZ,IAAlC,CAAwCa,IAAD,IAAU;AAC7C,aAAKvB,QAAL,CAAc;AAAEN,UAAAA,KAAK,EAAE,IAAT;AAAeG,UAAAA,KAAK,EAAE0B;AAAtB,SAAd,EAA4C,MAAM,KAAKrB,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,WAAxB,CAAlD;AACH,OAFD;AAIH,KA5DuB;;AAAA,SA6DxBoB,eA7DwB,GA6DN,MAAM;AACpBhD,MAAAA,KAAK,CAACiD,gBAAN,GACKf,IADL,CACUZ,IAAI,IAAI,KAAKE,QAAL,CAAc;AAAEF,QAAAA;AAAF,OAAd,EAAwB,MAAM,KAAKI,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,gBAAxB,CAA9B,CADlB;AAGH,KAjEuB;;AAAA,SAkExBsB,YAlEwB,GAkERC,OAAD,IAAa;AACxBnD,MAAAA,KAAK,CAACoD,aAAN,CAAoBD,OAApB,EACKjB,IADL,CACU,MAAMlC,KAAK,CAACiD,gBAAN,EADhB,EAEKf,IAFL,CAEUZ,IAAI,IAAI,KAAKE,QAAL,CAAc;AAAEF,QAAAA;AAAF,OAAd,EAAwB,MAAM,KAAKI,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,gBAAxB,CAA9B,CAFlB;AAIH,KAvEuB;;AAAA,SAyExByB,YAzEwB,GAyET,MAAM;AACjBrD,MAAAA,KAAK,CAACsD,UAAN;AAEA,WAAK5B,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,GAAxB;AACH,KA7EuB;;AAAA,SAkFxB2B,SAlFwB,GAkFZC,EAAE,IACVxD,KAAK,CAACoD,aAAN,CAAoBI,EAApB,EACKtB,IADL,CACU,MAAMlC,KAAK,CAACiD,gBAAN,EADhB,EAEKf,IAFL,CAEUZ,IAAI,IAAI,KAAKE,QAAL,CAAc;AAAEF,MAAAA;AAAF,KAAd,CAFlB,CAnFoB;;AAAA,SAuFxBmC,SAvFwB,GAuFZN,OAAO,IACfnD,KAAK,CAAC0D,mBAAN,CAA0BP,OAA1B,EACKjB,IADL,CACWb,KAAD,IAAW;AACbrB,MAAAA,KAAK,CAACiD,gBAAN,GACKf,IADL,CACUZ,IAAI,IAAI,KAAKE,QAAL,CAAc;AAAEN,QAAAA,KAAK,EAAE,IAAT;AAAeC,QAAAA,IAAI,EAAE,IAArB;AAA2BG,QAAAA,IAA3B;AAAiCD,QAAAA,KAAjC;AAAwCD,QAAAA,IAAI,EAAE+B;AAA9C,OAAd,EAAuE,MAAM,KAAKzB,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,wBAAxB,CAA7E,CADlB;AAEH,KAJL,EAKKS,KALL,CAKWnB,KAAK,IACR,KAAKM,QAAL,CAAc;AAAEN,MAAAA,KAAK,EAAEA,KAAK,CAACoB;AAAf,KAAd,CANR,CAxFoB;AAAA;;AA0BxBqB,EAAAA,iBAAiB,GAAG;AAChB3D,IAAAA,KAAK,CAAC4D,cAAN,IACI5D,KAAK,CAACmC,YAAN,GACKD,IADL,CACU2B,IAAI,IACN,KAAKrC,QAAL,CAAc;AAAEY,MAAAA,IAAI,EAAEyB,IAAI,CAACzB;AAAb,KAAd,CAFR,EAIKC,KAJL,CAIWnB,KAAK,IACR,KAAKM,QAAL,CAAc;AAAEN,MAAAA,KAAK,EAAEA,KAAK,CAACoB;AAAf,KAAd,CALR,CADJ;AAQH;;AA4CDwB,EAAAA,kBAAkB,CAACC,SAAD,EAAY;AAC1B,QAAI,KAAKrC,KAAL,CAAWsC,QAAX,KAAwBD,SAAS,CAACC,QAAtC,EAAgD,KAAKxC,QAAL,CAAc;AAAEP,MAAAA,OAAO,EAAE;AAAX,KAAd;AACnD;;AAgBDgD,EAAAA,MAAM,GAAG;AAAA,wBAeD,IAfC,CAEDnD,KAFC;AAAA,UAEQC,IAFR,eAEQA,IAFR;AAAA,UAEcG,KAFd,eAEcA,KAFd;AAAA,UAEqBG,KAFrB,eAEqBA,KAFrB;AAAA,UAE4BF,IAF5B,eAE4BA,IAF5B;AAAA,UAEkCG,IAFlC,eAEkCA,IAFlC;AAAA,UAEwCF,IAFxC,eAEwCA,IAFxC;AAAA,UAGDG,oBAHC,GAeD,IAfC,CAGDA,oBAHC;AAAA,UAIDE,wBAJC,GAeD,IAfC,CAIDA,wBAJC;AAAA,UAKDI,qBALC,GAeD,IAfC,CAKDA,qBALC;AAAA,UAMDC,WANC,GAeD,IAfC,CAMDA,WANC;AAAA,UAODS,cAPC,GAeD,IAfC,CAODA,cAPC;AAAA,UAQDc,YARC,GAeD,IAfC,CAQDA,YARC;AAAA,UASDV,cATC,GAeD,IAfC,CASDA,cATC;AAAA,UAUDC,cAVC,GAeD,IAfC,CAUDA,cAVC;AAAA,UAWDI,eAXC,GAeD,IAfC,CAWDA,eAXC;AAAA,UAYDE,YAZC,GAeD,IAfC,CAYDA,YAZC;AAAA,UAaDK,SAbC,GAeD,IAfC,CAaDA,SAbC;AAAA,UAcDE,SAdC,GAeD,IAfC,CAcDA,SAdC;AAiBL,WAAO;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACH,oBAAC,gBAAD;AAAkB,MAAA,IAAI,EAAE1C,IAAxB;AAA8B,MAAA,gBAAgB,EAAEQ,oBAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADG,EAGH,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,KAAD;AAAO,MAAA,KAAK,MAAZ;AAAa,MAAA,IAAI,EAAC,GAAlB;AAAsB,MAAA,MAAM,EAAE,MAAMvB,KAAK,CAAC4D,cAAN,GAAuB,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,OAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAvB,GAAiD,oBAAC,OAAD;AAAS,QAAA,IAAI,EAAE7C,IAAf;AAAqB,QAAA,UAAU,EAAEU,wBAAjC;AAA2D,QAAA,OAAO,EAAEI,qBAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAArF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAGI,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAC,WAAZ;AAAwB,MAAA,MAAM,EAAE,MAAM7B,KAAK,CAAC4D,cAAN,GAAuB,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,OAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAvB,GAAiD,oBAAC,QAAD;AAAU,QAAA,IAAI,EAAE7C,IAAhB;AAAsB,QAAA,UAAU,EAAEwB,cAAlC;AAAkD,QAAA,KAAK,EAAErB,KAAzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAvF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHJ,EAKI,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAC,QAAZ;AAAqB,MAAA,MAAM,EAAE,MAAMlB,KAAK,CAAC4D,cAAN,GAAuB,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,OAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAvB,GAAiD,oBAAC,KAAD;AAAO,QAAA,IAAI,EAAE7C,IAAb;AAAmB,QAAA,OAAO,EAAEe,WAA5B;AAAyC,QAAA,KAAK,EAAEZ,KAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAApF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALJ,EAOI,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAoB,MAAA,MAAM,EAAE,MAAMlB,KAAK,CAAC4D,cAAN,GAAuB,oBAAC,IAAD;AAAM,QAAA,IAAI,EAAE7C,IAAZ;AAAkB,QAAA,UAAU,EAAE4B,cAA9B;AAA8C,QAAA,UAAU,EAAEC,cAA1D;AAA0E,QAAA,WAAW,EAAEI,eAAvF;AAAwG,QAAA,QAAQ,EAAEK,YAAlH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAvB,GAA4J,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAA9L;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPJ,EASI,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAC,WAAZ;AAAwB,MAAA,MAAM,EAAE,MAAMrD,KAAK,CAAC4D,cAAN,GAAuB,oBAAC,UAAD;AAAY,QAAA,IAAI,EAAE7C,IAAlB;AAAwB,QAAA,KAAK,EAAEM,KAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAvB,GAAkE,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAxG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MATJ,EAWI,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAC,WAAZ;AAAwB,MAAA,MAAM,EAAE,MAAMrB,KAAK,CAAC4D,cAAN,GAAuB,oBAAC,UAAD;AAAY,QAAA,IAAI,EAAE7C,IAAlB;AAAwB,QAAA,KAAK,EAAEM,KAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAvB,GAAkE,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAxG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAXJ,EAaI,oBAAC,KAAD;AAAO,MAAA,KAAK,MAAZ;AAAa,MAAA,IAAI,EAAC,gBAAlB;AAAmC,MAAA,MAAM,EAAE,MAAMrB,KAAK,CAAC4D,cAAN,GAAuB,oBAAC,SAAD;AAAW,QAAA,IAAI,EAAE7C,IAAjB;AAAuB,QAAA,IAAI,EAAEO,IAA7B;AAAmC,QAAA,QAAQ,EAAE4B,YAA7C;AAA2D,QAAA,KAAK,EAAEO,SAAlE;AAA6E,QAAA,WAAW,EAAET,eAA1F;AAA2G,QAAA,IAAI,EAAE5B,IAAjH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAvB,GAAmJ,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAApM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAbJ,EAeI,oBAAC,KAAD;AAAO,MAAA,KAAK,MAAZ;AAAa,MAAA,IAAI,EAAC,wBAAlB;AAA2C,MAAA,MAAM,EAAE,MAAMpB,KAAK,CAAC4D,cAAN,GAAuB,oBAAC,UAAD;AAAY,QAAA,IAAI,EAAE7C,IAAlB;AAAwB,QAAA,KAAK,EAAEM,KAA/B;AAAsC,QAAA,KAAK,EAAEkC,SAA7C;AAAwD,QAAA,IAAI,EAAEnC,IAA9D;AAAoE,QAAA,KAAK,EAAEF,KAA3E;AAAkF,QAAA,IAAI,EAAEI,IAAxF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAvB,GAA0H,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAnL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAfJ,EAkBI,oBAAC,QAAD;AAAU,MAAA,EAAE,EAAC,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAlBJ,CAHG,CAAP;AAwBH;;AA1IuB;;AA6I5B,eAAehB,UAAU,CAACO,GAAD,CAAzB","sourcesContent":["import React, { Component } from 'react'\nimport i18n from '../common/i18n'\nimport LanguageSelector from './LanguageSelector'\nimport Landing from './Landing'\nimport Register from './Register'\nimport Login from './Login'\nimport logic from '../logic'\nimport Home from './Home';\nimport StopCode from './StopCode';\nimport StopLine from './StopLine';\nimport Results from './Results';\nimport { Route, withRouter, Redirect, Switch } from 'react-router-dom'\nimport Favorites from './Favorites';\nimport CodeSearch from './CodeSearch';\nimport LineSearch from './LineSearch';\nimport ResultsFav from './ResultsFav';\n\n\n\nclass App extends Component {\n    state = { lang: i18n.language, visible: null, error: null, line: null, stop: null, lines: [], favs: [] }\n\n    handleLanguageChange = lang => this.setState({ lang: i18n.language = lang })\n\n    handleRegisterNavigation = () => this.props.history.push('/register')\n\n    handleLoginNavigation = () => this.props.history.push('/login')\n\n    handleLogin = (username, password) => {\n        try {\n            logic.loginUser(username, password)\n                .then(() =>\n                    logic.retrieveUser()\n                )\n                .then(({ name }) => {\n                    this.setState({ name, error: null }, () => this.props.history.push('/home'))\n                })\n                .catch(error =>\n                    this.setState({ error: error.message })\n                )\n        } catch ({ message }) {\n            this.setState({ error: message })\n        }\n    }\n\n    componentDidMount() {\n        logic.isUserLoggedIn &&\n            logic.retrieveUser()\n                .then(user =>\n                    this.setState({ name: user.name })\n                )\n                .catch(error =>\n                    this.setState({ error: error.message })\n                )\n    }\n\n    handleRegister = (name, surname, username, password, password2) => {\n        try {\n\n            logic.registerUser(name, surname, username, password, password2)\n                .then(() => {\n                    this.setState({ error: null }, () => this.props.history.push('/login'))\n                })\n                .catch(error => {\n                    this.setState({ error: error.message })\n                })\n        } catch ({ message }) {\n            this.setState({ error: message })\n        }\n    }\n    handleStopCode = () => {\n\n        this.setState(() => this.props.history.push('/byidstop'))\n    }\n    handleLineCode = () => {\n        logic.retrieveBusLines(undefined).then((resp) => {\n            this.setState({ error: null, lines: resp }, () => this.props.history.push('/byidline'))\n        })\n\n    }\n    handleFavorites = () => {\n        logic.retrieveFavStops()\n            .then(favs => this.setState({ favs }, () => this.props.history.push('/favoritestops')))\n\n    }\n    handleFavOut = (stop_id) => {\n        logic.toggleFavStop(stop_id)\n            .then(() => logic.retrieveFavStops())\n            .then(favs => this.setState({ favs }, () => this.props.history.push('/favoritestops')))\n\n    }\n\n    handleLogout = () => {\n        logic.logoutUser()\n\n        this.props.history.push('/')\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.location !== prevProps.location) this.setState({ visible: null })\n    }\n    handleFav = id =>\n        logic.toggleFavStop(id)\n            .then(() => logic.retrieveFavStops())\n            .then(favs => this.setState({ favs }))\n\n    handleSee = stop_id =>\n        logic.upcomingBusesByStop(stop_id)\n            .then((lines) => {\n                logic.retrieveFavStops()\n                    .then(favs => this.setState({ error: null, line: null, favs, lines, stop: stop_id }, () => this.props.history.push('/favoritestops/results')))\n            })\n            .catch(error =>\n                this.setState({ error: error.message })\n            )\n\n    render() {\n        const {\n            state: { lang, error, lines, line, favs, stop },\n            handleLanguageChange,\n            handleRegisterNavigation,\n            handleLoginNavigation,\n            handleLogin,\n            handleRegister,\n            handleLogout,\n            handleStopCode,\n            handleLineCode,\n            handleFavorites,\n            handleFavOut,\n            handleFav,\n            handleSee\n        } = this\n\n        return <div className=\"main-app\">\n            <LanguageSelector lang={lang} onLanguageChange={handleLanguageChange} />\n\n            <Switch>\n                <Route exact path=\"/\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> : <Landing lang={lang} onRegister={handleRegisterNavigation} onLogin={handleLoginNavigation} />} />\n\n                <Route path=\"/register\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> : <Register lang={lang} onRegister={handleRegister} error={error} />} />\n\n                <Route path=\"/login\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> : <Login lang={lang} onLogin={handleLogin} error={error} />} />\n\n                <Route path=\"/home\" render={() => logic.isUserLoggedIn ? <Home lang={lang} onStopCode={handleStopCode} onLineCode={handleLineCode} onFavorites={handleFavorites} onLogout={handleLogout} /> : <Redirect to=\"/\" />} />\n\n                <Route path=\"/byidstop\" render={() => logic.isUserLoggedIn ? <CodeSearch lang={lang} items={lines} /> : <Redirect to=\"/\" />} />\n\n                <Route path=\"/byidline\" render={() => logic.isUserLoggedIn ? <LineSearch lang={lang} items={lines} /> : <Redirect to=\"/\" />} />\n\n                <Route exact path=\"/favoritestops\" render={() => logic.isUserLoggedIn ? <Favorites lang={lang} favs={favs} onFavOut={handleFavOut} onSee={handleSee} onFavorites={handleFavorites} stop={stop} /> : <Redirect to=\"/\" />} />\n\n                <Route exact path=\"/favoritestops/results\" render={() => logic.isUserLoggedIn ? <ResultsFav lang={lang} items={lines} onFav={handleFav} stop={stop} error={error} favs={favs} /> : <Redirect to=\"/\" />} />\n\n\n                <Redirect to=\"/\" />\n            </Switch>\n        </div>\n    }\n}\n\nexport default withRouter(App)"]},"metadata":{},"sourceType":"module"}