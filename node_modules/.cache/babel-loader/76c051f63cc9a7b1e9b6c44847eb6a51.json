{"ast":null,"code":"var _jsxFileName = \"/Users/didactor/Documents/skylab/bootcamp/collab/skylab-bootcamp-201904/staff/groups/aldi/siempre-tarde/src/componets/App.js\";\nimport React, { Component } from 'react';\nimport i18n from '../common/i18n';\nimport LanguageSelector from './LanguageSelector';\nimport Landing from './Landing';\nimport Register from './Register';\nimport Login from './Login';\nimport logic from '../logic';\nimport Home from './Home';\nimport StopCode from './StopCode';\nimport StopLine from './StopLine';\nimport Results from './Results';\nimport { Route, withRouter, Redirect, Switch } from 'react-router-dom';\nimport Favorites from './Favorites';\nimport CodeSearch from './CodeSearch';\nimport LineSearch from './LineSearch';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      lang: i18n.language,\n      visible: null,\n      error: null,\n      line: null,\n      lines: [],\n      favs: []\n    };\n\n    this.handleLanguageChange = lang => this.setState({\n      lang: i18n.language = lang\n    });\n\n    this.handleRegisterNavigation = () => this.props.history.push('/register');\n\n    this.handleLoginNavigation = () => this.props.history.push('/login');\n\n    this.handleLogin = (username, password) => {\n      try {\n        logic.loginUser(username, password).then(() => logic.retrieveUser()).then(({\n          name\n        }) => {\n          this.setState({\n            name,\n            error: null\n          }, () => this.props.history.push('/home'));\n        }).catch(error => this.setState({\n          error: error.message\n        }));\n      } catch (_ref) {\n        let message = _ref.message;\n        this.setState({\n          error: message\n        });\n      }\n    };\n\n    this.handleRegister = (name, surname, username, password, password2) => {\n      try {\n        logic.registerUser(name, surname, username, password, password2).then(() => {\n          this.setState({\n            error: null\n          }, () => this.props.history.push('/login'));\n        }).catch(error => {\n          this.setState({\n            error: error.message\n          });\n        });\n      } catch (_ref2) {\n        let message = _ref2.message;\n        this.setState({\n          error: message\n        });\n      }\n    };\n\n    this.handleStopCode = () => {\n      this.setState(() => this.props.history.push('/byidstop'));\n    };\n\n    this.handleLineCode = () => {\n      logic.retrieveBusLines(undefined).then(resp => {\n        this.setState({\n          error: null,\n          lines: resp\n        }, () => this.props.history.push('/byidline'));\n      });\n    };\n\n    this.handleFavorites = () => {\n      logic.retrieveFavStops().then(favs => this.setState({\n        favs\n      }, () => this.props.history.push('/favoritestops')));\n    };\n\n    this.handleFavOut = () => {\n      logic.retrieveFavStops().then(favs => this.setState({\n        favs\n      }, () => this.props.history.push('/favoritestops')));\n    };\n\n    this.handleLogout = () => {\n      logic.logoutUser();\n      this.props.history.push('/');\n    };\n  }\n\n  componentDidMount() {\n    logic.isUserLoggedIn && logic.retrieveUser().then(user => this.setState({\n      name: user.name\n    })).catch(error => this.setState({\n      error: error.message\n    }));\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.location !== prevProps.location) this.setState({\n      visible: null\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          lang = _this$state.lang,\n          error = _this$state.error,\n          lines = _this$state.lines,\n          line = _this$state.line,\n          favs = _this$state.favs,\n          handleLanguageChange = this.handleLanguageChange,\n          handleRegisterNavigation = this.handleRegisterNavigation,\n          handleLoginNavigation = this.handleLoginNavigation,\n          handleLogin = this.handleLogin,\n          handleRegister = this.handleRegister,\n          handleLogout = this.handleLogout,\n          handleStopCode = this.handleStopCode,\n          handleLineCode = this.handleLineCode,\n          handleFavorites = this.handleFavorites,\n          handleFavOut = this.handleFavOut;\n    return React.createElement(React.Fragment, null, React.createElement(LanguageSelector, {\n      lang: lang,\n      onLanguageChange: handleLanguageChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }), React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }) : React.createElement(Landing, {\n        lang: lang,\n        onRegister: handleRegisterNavigation,\n        onLogin: handleLoginNavigation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/register\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }) : React.createElement(Register, {\n        lang: lang,\n        onRegister: handleRegister,\n        error: error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/login\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }) : React.createElement(Login, {\n        lang: lang,\n        onLogin: handleLogin,\n        error: error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/home\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Home, {\n        lang: lang,\n        onStopCode: handleStopCode,\n        onLineCode: handleLineCode,\n        onFavorites: handleFavorites,\n        onLogout: handleLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/byidstop\",\n      render: () => logic.isUserLoggedIn ? React.createElement(CodeSearch, {\n        lang: lang,\n        items: lines,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/byidline\",\n      render: () => logic.isUserLoggedIn ? React.createElement(LineSearch, {\n        lang: lang,\n        items: lines,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/favoritestops\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Favorites, {\n        lang: lang,\n        favs: favs,\n        onFavOut: handleFavOut,\n        onFavorites: handleFavorites,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), React.createElement(Redirect, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["/Users/didactor/Documents/skylab/bootcamp/collab/skylab-bootcamp-201904/staff/groups/aldi/siempre-tarde/src/componets/App.js"],"names":["React","Component","i18n","LanguageSelector","Landing","Register","Login","logic","Home","StopCode","StopLine","Results","Route","withRouter","Redirect","Switch","Favorites","CodeSearch","LineSearch","App","state","lang","language","visible","error","line","lines","favs","handleLanguageChange","setState","handleRegisterNavigation","props","history","push","handleLoginNavigation","handleLogin","username","password","loginUser","then","retrieveUser","name","catch","message","handleRegister","surname","password2","registerUser","handleStopCode","handleLineCode","retrieveBusLines","undefined","resp","handleFavorites","retrieveFavStops","handleFavOut","handleLogout","logoutUser","componentDidMount","isUserLoggedIn","user","componentDidUpdate","prevProps","location","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport i18n from '../common/i18n'\nimport LanguageSelector from './LanguageSelector'\nimport Landing from './Landing'\nimport Register from './Register'\nimport Login from './Login'\nimport logic from '../logic'\nimport Home from './Home';\nimport StopCode from './StopCode';\nimport StopLine from './StopLine';\nimport Results from './Results';\nimport { Route, withRouter, Redirect, Switch } from 'react-router-dom'\nimport Favorites from './Favorites';\nimport CodeSearch from './CodeSearch';\nimport LineSearch from './LineSearch';\n\n\n\nclass App extends Component {\n    state = { lang: i18n.language, visible: null, error: null, line: null, lines:[], favs:[] }\n\n    handleLanguageChange = lang => this.setState({ lang: i18n.language = lang })\n\n    handleRegisterNavigation = () => this.props.history.push('/register')\n\n    handleLoginNavigation = () => this.props.history.push('/login')\n\n    handleLogin = (username, password) => {\n        try {\n            logic.loginUser(username, password)\n                .then(() =>\n                    logic.retrieveUser()\n                )\n                .then(({ name }) => {\n                    this.setState({ name, error: null }, () => this.props.history.push('/home'))\n                })\n                .catch(error =>\n                    this.setState({ error: error.message })\n                )\n        } catch ({ message }) {\n            this.setState({ error: message })\n        }\n    }\n\n    componentDidMount() {\n        logic.isUserLoggedIn &&\n            logic.retrieveUser()\n                .then(user =>\n                    this.setState({ name: user.name })\n                )\n                .catch(error =>\n                    this.setState({ error: error.message })\n                )\n    }\n\n    handleRegister = (name, surname, username, password, password2) => {\n        try {\n\n            logic.registerUser(name, surname, username, password, password2)\n                .then(() =>{\n                    this.setState({ error: null },() => this.props.history.push('/login'))\n                })\n                .catch(error =>{\n                    this.setState({ error: error.message })\n                })\n        } catch ({ message }) {\n            this.setState({ error: message })\n        }\n    }\n    handleStopCode = () => {\n\n        this.setState(() => this.props.history.push('/byidstop'))\n    }\n    handleLineCode = () => {\n        logic.retrieveBusLines(undefined).then((resp)=>{\n            this.setState({ error:null, lines:resp },() => this.props.history.push('/byidline'))\n        })\n\n    }\n    handleFavorites = () => {\n        logic.retrieveFavStops()\n        .then(favs => this.setState({ favs },() => this.props.history.push('/favoritestops')))\n\n    }\n    handleFavOut = () => {\n        logic.retrieveFavStops()\n        .then(favs => this.setState({ favs },() => this.props.history.push('/favoritestops')))\n\n    }\n\n    handleLogout = () => {\n        logic.logoutUser()\n\n        this.props.history.push('/')\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.location !== prevProps.location) this.setState({ visible: null })\n    }\n\n    render() {\n        const {\n            state: { lang, error, lines, line, favs},\n            handleLanguageChange,\n            handleRegisterNavigation,\n            handleLoginNavigation,\n            handleLogin,\n            handleRegister,\n            handleLogout,\n            handleStopCode,\n            handleLineCode,\n            handleFavorites,\n            handleFavOut\n        } = this\n\n        return <>\n            <LanguageSelector lang={lang} onLanguageChange={handleLanguageChange} />\n\n            <Switch>\n                <Route exact path=\"/\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> : <Landing lang={lang} onRegister={handleRegisterNavigation} onLogin={handleLoginNavigation} />} />\n\n                <Route path=\"/register\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> :<Register lang={lang} onRegister={handleRegister} error={error}/>} />\n\n                <Route path=\"/login\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> : <Login lang={lang} onLogin={handleLogin} error={error} />} />\n\n                <Route path=\"/home\" render={() => logic.isUserLoggedIn ? <Home lang={lang} onStopCode={handleStopCode} onLineCode={handleLineCode} onFavorites={handleFavorites} onLogout={handleLogout} /> : <Redirect to=\"/\" />} />\n                \n                <Route path=\"/byidstop\" render={() => logic.isUserLoggedIn ? <CodeSearch lang={lang} items={lines}/> : <Redirect to=\"/\" />} />\n\n\n                <Route path=\"/byidline\" render={() => logic.isUserLoggedIn ? <LineSearch lang={lang} items={lines}/> : <Redirect to=\"/\" />} />\n\n                <Route path=\"/favoritestops\" render={() => logic.isUserLoggedIn ? <Favorites lang={lang} favs={favs} onFavOut={handleFavOut} onFavorites={handleFavorites} /> : <Redirect to=\"/\" />} />\n\n\n                <Redirect to=\"/\" />\n            </Switch>\n        </>\n    }\n}\n\nexport default withRouter(App)"]},"metadata":{},"sourceType":"module"}