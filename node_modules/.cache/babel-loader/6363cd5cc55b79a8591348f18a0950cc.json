{"ast":null,"code":"import validate from '../../common/validate';\nimport call from '../../common/call';\nimport { NotFoundError, ConnectionError } from '../../common/errors';\nconst transitApi = {\n  APP_ID: null,\n  APP_KEY: null,\n  __url_lines__: 'https://api.tmb.cat/v1/transit/linies/bus',\n  __url_stops__: 'https://api.tmb.cat/v1/transit/parades/',\n  __timeout__: 0,\n\n  retrieveBusLine(line_id) {\n    validate.arguments([{\n      name: 'line',\n      value: line_id,\n      type: 'number',\n      notEmpty: true,\n      optional: true\n    }]);\n    let path;\n    line_id ? path = line_id : path = '';\n    return call(\"\".concat(this.__url_lines__, \"/\").concat(path, \"?app_id=\").concat(this.APP_ID, \"&app_key=\").concat(this.APP_KEY), {\n      timeout: this.__timeout__\n    }).then(response => {\n      if (response.status === 200) {\n        return response.json();\n      }\n\n      if (response.status === 404) throw new NotFoundError('cannot found');\n      if (response.status === 403) throw new ConnectionError('cannot connect');\n    }).then(response => {\n      if (response.totalFeatures === 0) {\n        throw new NotFoundError('cannot found');\n      } else {\n        return response;\n      }\n    });\n  },\n\n  retrieveBusLineRoute(line_id) {\n    validate.arguments([{\n      name: 'line',\n      value: line_id,\n      type: 'number',\n      notEmpty: true,\n      optional: false\n    }]);\n    return call(\"\".concat(this.__url_lines__, \"/\").concat(line_id, \"/recs?app_id=\").concat(this.APP_ID, \"&app_key=\").concat(this.APP_KEY), {\n      timeout: this.__timeout__\n    }).then(response => {\n      if (response.status === 200) {\n        return response.json();\n      }\n\n      if (response.status === 404) throw new NotFoundError('cannot found');\n      if (response.status === 403) throw new ConnectionError('cannot connect');\n    }).then(response => {\n      if (response.totalFeatures === 0) {\n        throw new NotFoundError('cannot found');\n      } else {\n        return response;\n      }\n    });\n  },\n\n  retrieveBusStops(line_id) {\n    validate.arguments([{\n      name: 'line',\n      value: line_id,\n      type: 'number',\n      notEmpty: true,\n      optional: false\n    }]);\n    let path = '';\n    if (line_id) path = line_id;\n    return call(\"\".concat(this.__url_lines__, \"/\").concat(line_id, \"/parades?app_id=\").concat(this.APP_ID, \"&app_key=\").concat(this.APP_KEY), {\n      timeout: this.__timeout__\n    }).then(response => {\n      if (response.status === 200) {\n        return response.json();\n      }\n\n      if (response.status === 404) throw new NotFoundError('cannot found');\n      if (response.status === 403) throw new ConnectionError('cannot connect');\n    }).then(response => {\n      if (response.totalFeatures === 0) {\n        throw new NotFoundError('cannot found');\n      } else {\n        return response;\n      }\n    });\n  },\n\n  retrieveStop(stop_id) {\n    validate.arguments([{\n      name: 'stop',\n      value: stop_id,\n      type: 'number',\n      notEmpty: true,\n      optional: false\n    }]);\n    return call(\"\".concat(this.__url_stops__, \"/\").concat(stop_id, \"?app_id=\").concat(this.APP_ID, \"&app_key=\").concat(this.APP_KEY), {\n      timeout: this.__timeout__\n    }).then(response => {\n      if (response.status === 200) {\n        return response.json();\n      }\n\n      if (response.status === 404) throw new NotFoundError('cannot found');\n      if (response.status === 403) throw new ConnectionError('cannot connect');\n    }).then(response => {\n      if (response.totalFeatures === 0) {\n        throw new NotFoundError('cannot found');\n      } else {\n        return response;\n      }\n    });\n  }\n\n};\nexport default transitApi;","map":{"version":3,"sources":["/Users/didactor/Documents/skylab/bootcamp/collab/skylab-bootcamp-201904/staff/groups/aldi/siempre-tarde/src/data/transit-api/index.js"],"names":["validate","call","NotFoundError","ConnectionError","transitApi","APP_ID","APP_KEY","__url_lines__","__url_stops__","__timeout__","retrieveBusLine","line_id","arguments","name","value","type","notEmpty","optional","path","timeout","then","response","status","json","totalFeatures","retrieveBusLineRoute","retrieveBusStops","retrieveStop","stop_id"],"mappings":"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","sourcesContent":["import validate from '../../common/validate'\nimport call from '../../common/call'\nimport { NotFoundError, ConnectionError } from '../../common/errors';\n\n\nconst transitApi = {\n    APP_ID: null,\n    APP_KEY: null,\n\n\n    __url_lines__: 'https://api.tmb.cat/v1/transit/linies/bus',\n    __url_stops__ : 'https://api.tmb.cat/v1/transit/parades/',\n    __timeout__: 0,\n\n    \n    retrieveBusLine(line_id) {\n        validate.arguments([\n            { name: 'line', value: line_id, type: 'number', notEmpty: true, optional: true }\n        ])\n\n        let path\n        line_id ? path = line_id : path = ''\n        return call(`${this.__url_lines__}/${path}?app_id=${this.APP_ID}&app_key=${this.APP_KEY}`, {\n            timeout: this.__timeout__\n        })\n            .then(response => {\n                if (response.status === 200) { \n                    return response.json()\n                }  \n                if (response.status === 404) throw new NotFoundError('cannot found')\n                if (response.status === 403) throw new ConnectionError('cannot connect')  \n            })\n            .then( response =>{\n                if (response.totalFeatures === 0){ \n                    throw new NotFoundError('cannot found')\n                }else { return response }\n            })\n\n    },\n\n    \n    retrieveBusLineRoute(line_id) {\n        validate.arguments([\n            { name: 'line', value: line_id, type: 'number', notEmpty: true, optional: false }\n        ])\n\n        return call(`${this.__url_lines__}/${line_id}/recs?app_id=${this.APP_ID}&app_key=${this.APP_KEY}`, {\n            timeout: this.__timeout__\n        })\n        .then(response => {\n            if (response.status === 200) { \n                return response.json()\n            }  \n            if (response.status === 404) throw new NotFoundError('cannot found')\n            if (response.status === 403) throw new ConnectionError('cannot connect')  \n        })\n        .then( response =>{\n            if (response.totalFeatures === 0){ \n                throw new NotFoundError('cannot found')\n            }else { return response }\n        })\n    },\n\n\n    \n    retrieveBusStops(line_id) {\n        validate.arguments([\n            { name: 'line', value: line_id, type: 'number', notEmpty: true, optional: false }\n        ])\n\n        let path = ''\n        if (line_id) path = line_id\n        return call(`${this.__url_lines__}/${line_id}/parades?app_id=${this.APP_ID}&app_key=${this.APP_KEY}`, {\n            timeout: this.__timeout__\n        })\n        .then(response => {\n            if (response.status === 200) { \n                return response.json()\n            }  \n            if (response.status === 404) throw new NotFoundError('cannot found')\n            if (response.status === 403) throw new ConnectionError('cannot connect')  \n        })\n        .then( response =>{\n            if (response.totalFeatures === 0){ \n                throw new NotFoundError('cannot found')\n            }else { return response }\n        })\n    },\n\n\n    retrieveStop(stop_id) {\n        validate.arguments([\n            { name: 'stop', value: stop_id, type: 'number', notEmpty: true, optional: false }\n        ])\n        \n        return call(`${this.__url_stops__}/${stop_id}?app_id=${this.APP_ID}&app_key=${this.APP_KEY}`, {\n            timeout: this.__timeout__\n        })\n        .then(response => {\n            if (response.status === 200) { \n                return response.json()\n            }  \n            if (response.status === 404) throw new NotFoundError('cannot found')\n            if (response.status === 403) throw new ConnectionError('cannot connect')  \n        })\n        .then( response =>{\n            if (response.totalFeatures === 0){ \n                throw new NotFoundError('cannot found')\n            }else { return response }\n        })\n    },\n\n\n\n}\n\nexport default transitApi"]},"metadata":{},"sourceType":"module"}