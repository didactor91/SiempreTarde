{"ast":null,"code":"var _jsxFileName = \"/Users/didactor/Documents/skylab/bootcamp/collab/skylab-bootcamp-201904/staff/groups/aldi/siempre-tarde/src/componets/App.js\";\nimport React, { Component } from 'react';\nimport i18n from '../common/i18n';\nimport LanguageSelector from './LanguageSelector';\nimport Landing from './Landing';\nimport Register from './Register';\nimport Login from './Login';\nimport logic from '../logic';\nimport Home from './Home';\nimport StopCode from './StopCode';\nimport StopLine from './StopLine';\nimport Results from './Results';\nimport { Route, withRouter, Redirect, Switch } from 'react-router-dom';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      lang: i18n.language,\n      visible: null,\n      error: null,\n      name: null\n    };\n\n    this.handleLanguageChange = lang => this.setState({\n      lang: i18n.language = lang\n    });\n\n    this.handleRegisterNavigation = () => this.props.history.push('/register');\n\n    this.handleLoginNavigation = () => this.props.history.push('/login');\n\n    this.handleLogin = (username, password) => {\n      try {\n        logic.loginUser(username, password).then(() => logic.retrieveUser()).then(({\n          name\n        }) => {\n          this.setState({\n            name,\n            error: null\n          }, () => this.props.history.push('/home'));\n        }).catch(error => this.setState({\n          error: error.message\n        }));\n      } catch (_ref) {\n        let message = _ref.message;\n        this.setState({\n          error: message\n        });\n      }\n    };\n\n    this.handleRegister = (name, surname, username, password, password2) => {\n      try {\n        logic.registerUser(name, surname, username, password, password2).then(() => {\n          this.setState({\n            error: null\n          }, () => this.props.history.push('/login'));\n        }).catch(error => {\n          this.setState({\n            error: error.message\n          });\n        });\n      } catch (_ref2) {\n        let message = _ref2.message;\n        this.setState({\n          error: message\n        });\n      }\n    };\n\n    this.handleLogout = () => {\n      logic.logoutUser();\n      this.props.history.push('/');\n    };\n  }\n\n  componentDidMount() {\n    logic.isUserLoggedIn && logic.retrieveUser().then(user => this.setState({\n      name: user.name\n    })).catch(error => this.setState({\n      error: error.message\n    }));\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.location !== prevProps.location) this.setState({\n      visible: null\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          lang = _this$state.lang,\n          error = _this$state.error,\n          name = _this$state.name,\n          handleLanguageChange = this.handleLanguageChange,\n          handleRegisterNavigation = this.handleRegisterNavigation,\n          handleLoginNavigation = this.handleLoginNavigation,\n          handleLogin = this.handleLogin,\n          handleRegister = this.handleRegister,\n          handleLogout = this.handleLogout;\n    return React.createElement(React.Fragment, null, React.createElement(LanguageSelector, {\n      lang: lang,\n      onLanguageChange: handleLanguageChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }), React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }) : React.createElement(Landing, {\n        lang: lang,\n        onRegister: handleRegisterNavigation,\n        onLogin: handleLoginNavigation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/register\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }) : React.createElement(Register, {\n        lang: lang,\n        onRegister: handleRegister,\n        error: error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/login\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }) : React.createElement(Login, {\n        lang: lang,\n        onLogin: handleLogin,\n        error: error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/home\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Home, {\n        lang: lang,\n        name: name,\n        onLogout: handleLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/stopbyid\",\n      render: () => logic.isUserLoggedIn ? React.createElement(StopCode, {\n        lang: lang,\n        name: name,\n        onStopCode: handleLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }), React.createElement(Redirect, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["/Users/didactor/Documents/skylab/bootcamp/collab/skylab-bootcamp-201904/staff/groups/aldi/siempre-tarde/src/componets/App.js"],"names":["React","Component","i18n","LanguageSelector","Landing","Register","Login","logic","Home","StopCode","StopLine","Results","Route","withRouter","Redirect","Switch","App","state","lang","language","visible","error","name","handleLanguageChange","setState","handleRegisterNavigation","props","history","push","handleLoginNavigation","handleLogin","username","password","loginUser","then","retrieveUser","catch","message","handleRegister","surname","password2","registerUser","handleLogout","logoutUser","componentDidMount","isUserLoggedIn","user","componentDidUpdate","prevProps","location","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport i18n from '../common/i18n'\nimport LanguageSelector from './LanguageSelector'\nimport Landing from './Landing'\nimport Register from './Register'\nimport Login from './Login'\nimport logic from '../logic'\nimport Home from './Home';\nimport StopCode from './StopCode';\nimport StopLine from './StopLine';\nimport Results from './Results';\nimport { Route, withRouter, Redirect, Switch } from 'react-router-dom'\n\n\n\nclass App extends Component {\n    state = { lang: i18n.language, visible: null, error: null, name: null }\n\n    handleLanguageChange = lang => this.setState({ lang: i18n.language = lang })\n\n    handleRegisterNavigation = () => this.props.history.push('/register')\n\n    handleLoginNavigation = () => this.props.history.push('/login')\n\n    handleLogin = (username, password) => {\n        try {\n            logic.loginUser(username, password)\n                .then(() =>\n                    logic.retrieveUser()\n                )\n                .then(({ name }) => {\n                    this.setState({ name, error: null }, () => this.props.history.push('/home'))\n                })\n                .catch(error =>\n                    this.setState({ error: error.message })\n                )\n        } catch ({ message }) {\n            this.setState({ error: message })\n        }\n    }\n\n    componentDidMount() {\n        logic.isUserLoggedIn &&\n            logic.retrieveUser()\n                .then(user =>\n                    this.setState({ name: user.name })\n                )\n                .catch(error =>\n                    this.setState({ error: error.message })\n                )\n    }\n\n    handleRegister = (name, surname, username, password, password2) => {\n        try {\n\n            logic.registerUser(name, surname, username, password, password2)\n                .then(() =>{\n                    this.setState({ error: null },() => this.props.history.push('/login'))\n                })\n                .catch(error =>{\n                    this.setState({ error: error.message })\n                })\n        } catch ({ message }) {\n            this.setState({ error: message })\n        }\n    }\n\n    handleLogout = () => {\n        logic.logoutUser()\n\n        this.props.history.push('/')\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.location !== prevProps.location) this.setState({ visible: null })\n    }\n\n    render() {\n        const {\n            state: { lang, error, name},\n            handleLanguageChange,\n            handleRegisterNavigation,\n            handleLoginNavigation,\n            handleLogin,\n            handleRegister,\n            handleLogout\n        } = this\n\n        return <>\n            <LanguageSelector lang={lang} onLanguageChange={handleLanguageChange} />\n\n            <Switch>\n                <Route exact path=\"/\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> : <Landing lang={lang} onRegister={handleRegisterNavigation} onLogin={handleLoginNavigation} />} />\n\n                <Route path=\"/register\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> :<Register lang={lang} onRegister={handleRegister} error={error}/>} />\n\n                <Route path=\"/login\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> : <Login lang={lang} onLogin={handleLogin} error={error} />} />\n\n                <Route path=\"/home\" render={() => logic.isUserLoggedIn ? <Home lang={lang} name={name} onLogout={handleLogout} /> : <Redirect to=\"/\" />} />\n                \n                <Route path=\"/stopbyid\" render={() => logic.isUserLoggedIn ? <StopCode lang={lang} name={name} onStopCode={handleLogout} /> : <Redirect to=\"/\" />} />\n\n\n                <Redirect to=\"/\" />\n            </Switch>\n        </>\n    }\n}\n\nexport default withRouter(App)"]},"metadata":{},"sourceType":"module"}