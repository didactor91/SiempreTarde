{"ast":null,"code":"var _jsxFileName = \"/Users/didactor/Documents/skylab/bootcamp/collab/skylab-bootcamp-201904/staff/groups/aldi/siempre-tarde/src/componets/App.js\";\nimport React, { Component } from 'react';\nimport i18n from '../common/i18n';\nimport LanguageSelector from './LanguageSelector';\nimport Landing from './Landing';\nimport Register from './Register';\nimport Login from './Login';\nimport logic from '../logic';\nimport Home from './Home';\nimport StopCode from './StopCode';\nimport StopLine from './StopLine';\nimport Results from './Results';\nimport { Route, withRouter, Redirect, Switch } from 'react-router-dom';\nimport Favorites from './Favorites';\nimport CodeSearch from './CodeSearch';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      lang: i18n.language,\n      visible: null,\n      error: null,\n      line: null,\n      lines: []\n    };\n\n    this.handleLanguageChange = lang => this.setState({\n      lang: i18n.language = lang\n    });\n\n    this.handleRegisterNavigation = () => this.props.history.push('/register');\n\n    this.handleLoginNavigation = () => this.props.history.push('/login');\n\n    this.handleLogin = (username, password) => {\n      try {\n        logic.loginUser(username, password).then(() => logic.retrieveUser()).then(({\n          name\n        }) => {\n          this.setState({\n            name,\n            error: null\n          }, () => this.props.history.push('/home'));\n        }).catch(error => this.setState({\n          error: error.message\n        }));\n      } catch (_ref) {\n        let message = _ref.message;\n        this.setState({\n          error: message\n        });\n      }\n    };\n\n    this.handleRegister = (name, surname, username, password, password2) => {\n      try {\n        logic.registerUser(name, surname, username, password, password2).then(() => {\n          this.setState({\n            error: null\n          }, () => this.props.history.push('/login'));\n        }).catch(error => {\n          this.setState({\n            error: error.message\n          });\n        });\n      } catch (_ref2) {\n        let message = _ref2.message;\n        this.setState({\n          error: message\n        });\n      }\n    };\n\n    this.handleStopCode = () => {\n      this.setState(() => this.props.history.push('/byidstop'));\n    };\n\n    this.handleLineCode = () => {\n      logic.retrieveBusLines(undefined).then(lines => {\n        this.setState({\n          error: null,\n          line: null,\n          lines\n        }, () => this.props.history.push('/byidline'));\n      });\n    };\n\n    this.handleFavorites = () => {\n      this.setState(() => this.props.history.push('/favoritestops'));\n    };\n\n    this.handleLogout = () => {\n      logic.logoutUser();\n      this.props.history.push('/');\n    };\n  }\n\n  componentDidMount() {\n    logic.isUserLoggedIn && logic.retrieveUser().then(user => this.setState({\n      name: user.name\n    })).catch(error => this.setState({\n      error: error.message\n    }));\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.location !== prevProps.location) this.setState({\n      visible: null\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          lang = _this$state.lang,\n          error = _this$state.error,\n          name = _this$state.name,\n          handleLanguageChange = this.handleLanguageChange,\n          handleRegisterNavigation = this.handleRegisterNavigation,\n          handleLoginNavigation = this.handleLoginNavigation,\n          handleLogin = this.handleLogin,\n          handleRegister = this.handleRegister,\n          handleLogout = this.handleLogout,\n          handleStopCode = this.handleStopCode,\n          handleLineCode = this.handleLineCode,\n          handleFavorites = this.handleFavorites;\n    return React.createElement(React.Fragment, null, React.createElement(LanguageSelector, {\n      lang: lang,\n      onLanguageChange: handleLanguageChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }) : React.createElement(Landing, {\n        lang: lang,\n        onRegister: handleRegisterNavigation,\n        onLogin: handleLoginNavigation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/register\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }) : React.createElement(Register, {\n        lang: lang,\n        onRegister: handleRegister,\n        error: error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/login\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }) : React.createElement(Login, {\n        lang: lang,\n        onLogin: handleLogin,\n        error: error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/home\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Home, {\n        lang: lang,\n        onStopCode: handleStopCode,\n        onLineCode: handleLineCode,\n        onFavorites: handleFavorites,\n        onLogout: handleLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/byidstop\",\n      render: () => logic.isUserLoggedIn ? React.createElement(CodeSearch, {\n        lang: lang,\n        name: name,\n        onStopCode: handleLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/byidline\",\n      render: () => logic.isUserLoggedIn ? React.createElement(StopLine, {\n        lang: lang,\n        name: name,\n        onStopCode: handleLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/favoritestops\",\n      render: () => logic.isUserLoggedIn ? React.createElement(Favorites, {\n        lang: lang,\n        name: name,\n        onStopCode: handleLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }), React.createElement(Redirect, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["/Users/didactor/Documents/skylab/bootcamp/collab/skylab-bootcamp-201904/staff/groups/aldi/siempre-tarde/src/componets/App.js"],"names":["React","Component","i18n","LanguageSelector","Landing","Register","Login","logic","Home","StopCode","StopLine","Results","Route","withRouter","Redirect","Switch","Favorites","CodeSearch","App","state","lang","language","visible","error","line","lines","handleLanguageChange","setState","handleRegisterNavigation","props","history","push","handleLoginNavigation","handleLogin","username","password","loginUser","then","retrieveUser","name","catch","message","handleRegister","surname","password2","registerUser","handleStopCode","handleLineCode","retrieveBusLines","undefined","handleFavorites","handleLogout","logoutUser","componentDidMount","isUserLoggedIn","user","componentDidUpdate","prevProps","location","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport i18n from '../common/i18n'\nimport LanguageSelector from './LanguageSelector'\nimport Landing from './Landing'\nimport Register from './Register'\nimport Login from './Login'\nimport logic from '../logic'\nimport Home from './Home';\nimport StopCode from './StopCode';\nimport StopLine from './StopLine';\nimport Results from './Results';\nimport { Route, withRouter, Redirect, Switch } from 'react-router-dom'\nimport Favorites from './Favorites';\nimport CodeSearch from './CodeSearch';\n\n\n\nclass App extends Component {\n    state = { lang: i18n.language, visible: null, error: null, line: null, lines:[] }\n\n    handleLanguageChange = lang => this.setState({ lang: i18n.language = lang })\n\n    handleRegisterNavigation = () => this.props.history.push('/register')\n\n    handleLoginNavigation = () => this.props.history.push('/login')\n\n    handleLogin = (username, password) => {\n        try {\n            logic.loginUser(username, password)\n                .then(() =>\n                    logic.retrieveUser()\n                )\n                .then(({ name }) => {\n                    this.setState({ name, error: null }, () => this.props.history.push('/home'))\n                })\n                .catch(error =>\n                    this.setState({ error: error.message })\n                )\n        } catch ({ message }) {\n            this.setState({ error: message })\n        }\n    }\n\n    componentDidMount() {\n        logic.isUserLoggedIn &&\n            logic.retrieveUser()\n                .then(user =>\n                    this.setState({ name: user.name })\n                )\n                .catch(error =>\n                    this.setState({ error: error.message })\n                )\n    }\n\n    handleRegister = (name, surname, username, password, password2) => {\n        try {\n\n            logic.registerUser(name, surname, username, password, password2)\n                .then(() =>{\n                    this.setState({ error: null },() => this.props.history.push('/login'))\n                })\n                .catch(error =>{\n                    this.setState({ error: error.message })\n                })\n        } catch ({ message }) {\n            this.setState({ error: message })\n        }\n    }\n    handleStopCode = () => {\n\n        this.setState(() => this.props.history.push('/byidstop'))\n    }\n    handleLineCode = () => {\n        logic.retrieveBusLines(undefined).then((lines)=>{\n\n            this.setState({ error:null, line: null, lines},() => this.props.history.push('/byidline'))\n        })\n\n        \n    }\n    handleFavorites = () => {\n\n        this.setState(() => this.props.history.push('/favoritestops'))\n    }\n\n    handleLogout = () => {\n        logic.logoutUser()\n\n        this.props.history.push('/')\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.location !== prevProps.location) this.setState({ visible: null })\n    }\n\n    render() {\n        const {\n            state: { lang, error, name},\n            handleLanguageChange,\n            handleRegisterNavigation,\n            handleLoginNavigation,\n            handleLogin,\n            handleRegister,\n            handleLogout,\n            handleStopCode,\n            handleLineCode,\n            handleFavorites\n        } = this\n\n        return <>\n            <LanguageSelector lang={lang} onLanguageChange={handleLanguageChange} />\n\n            <Switch>\n                <Route exact path=\"/\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> : <Landing lang={lang} onRegister={handleRegisterNavigation} onLogin={handleLoginNavigation} />} />\n\n                <Route path=\"/register\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> :<Register lang={lang} onRegister={handleRegister} error={error}/>} />\n\n                <Route path=\"/login\" render={() => logic.isUserLoggedIn ? <Redirect to=\"/home\" /> : <Login lang={lang} onLogin={handleLogin} error={error} />} />\n\n                <Route path=\"/home\" render={() => logic.isUserLoggedIn ? <Home lang={lang} onStopCode={handleStopCode} onLineCode={handleLineCode} onFavorites={handleFavorites} onLogout={handleLogout} /> : <Redirect to=\"/\" />} />\n                \n                <Route path=\"/byidstop\" render={() => logic.isUserLoggedIn ? <CodeSearch lang={lang} name={name} onStopCode={handleLogout} /> : <Redirect to=\"/\" />} />\n\n\n                <Route path=\"/byidline\" render={() => logic.isUserLoggedIn ? <StopLine lang={lang} name={name} onStopCode={handleLogout} /> : <Redirect to=\"/\" />} />\n\n                <Route path=\"/favoritestops\" render={() => logic.isUserLoggedIn ? <Favorites lang={lang} name={name} onStopCode={handleLogout} /> : <Redirect to=\"/\" />} />\n\n\n                <Redirect to=\"/\" />\n            </Switch>\n        </>\n    }\n}\n\nexport default withRouter(App)"]},"metadata":{},"sourceType":"module"}